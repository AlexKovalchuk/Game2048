<Window
    x:Class="Game2048.Desktop.MainWindow"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:vm="clr-namespace:Game2048.Desktop.ViewModels"
    x:DataType="vm:GameViewModel"
    Background="#faf8ef"
    Width="540" Height="700"
    d:DesignWidth="540" d:DesignHeight="700">

    <Design.DataContext>
        <vm:GameViewModel />
    </Design.DataContext>

    <Window.KeyBindings>
        <KeyBinding Command="{Binding MoveUpCommand}" Gesture="Up" />
        <KeyBinding Command="{Binding MoveDownCommand}" Gesture="Down" />
        <KeyBinding Command="{Binding MoveLeftCommand}" Gesture="Left" />
        <KeyBinding Command="{Binding MoveRightCommand}" Gesture="Right" />
        <KeyBinding Command="{Binding NewGameCommand}" Gesture="R" />
    </Window.KeyBindings>

    <Grid RowDefinitions="Auto Auto *" Margin="20">

        <Grid Margin="0,16,0,8" ColumnDefinitions="Auto,*,Auto">
            
            <TextBlock Grid.Column="0"
                       Text="2048"
                       FontSize="36"
                       FontWeight="Bold"
                       Foreground="#776e65"
                       VerticalAlignment="Center" />
            
            <StackPanel Grid.Column="1"
                        Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        Spacing="8"
                        VerticalAlignment="Center">

                <Border Background="#bbada0"
                        CornerRadius="4"
                        Padding="8,4">
                    <StackPanel>
                        <TextBlock Text="SCORE"
                                   FontSize="10"
                                   Foreground="#eee4da"
                                   HorizontalAlignment="Center" />
                        <TextBlock Text="{Binding Score}"
                                   FontSize="16"
                                   FontWeight="Bold"
                                   Foreground="#ffffff"
                                   HorizontalAlignment="Center" />
                    </StackPanel>
                </Border>

                <Border Background="#bbada0"
                        CornerRadius="4"
                        Padding="8,4">
                    <StackPanel>
                        <TextBlock Text="SIZE"
                                   FontSize="10"
                                   Foreground="#eee4da"
                                   HorizontalAlignment="Center" />
                        <TextBlock Text="{Binding BoardSize}"
                                   FontSize="16"
                                   FontWeight="Bold"
                                   Foreground="#ffffff"
                                   HorizontalAlignment="Center" />
                    </StackPanel>
                </Border>
            </StackPanel>
            
            <Button Grid.Column="2"
                    Content="New Game"
                    Command="{Binding NewGameCommand}"
                    Background="#A8E6A3"
                    Foreground="#333"
                    Padding="12,8"
                    CornerRadius="6"
                    FontWeight="Bold"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center" />
        </Grid>


        <!-- STATUS -->
        <TextBlock Grid.Row="1"
                   Text="{Binding StateText}"
                   Foreground="#776e65"
                   FontSize="16"
                   Margin="0,12,0,12" />


        <!-- GAME BOARD -->
        <Border Grid.Row="2"
                Background="#bbada0"
                CornerRadius="8"
                Padding="8">

            <ItemsControl ItemsSource="{Binding Tiles}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <UniformGrid Rows="{Binding BoardSize}"
                                     Columns="{Binding BoardSize}" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>

                <ItemsControl.ItemTemplate>
                    <DataTemplate x:DataType="vm:TileViewModel">
                        <Border Width="110"
                                Height="110"
                                Margin="6"
                                CornerRadius="6"
                                Background="{Binding Background}"
                                BorderBrush="#cdc1b4"
                                BorderThickness="2">

                            <TextBlock Text="{Binding Value}"
                                       FontSize="32"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Foreground="{Binding Foreground}" />
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Border>
    </Grid>
    
    <Style Selector="Button.new-game-button">
        <Setter Property="Background" Value="#C5F5C7"/>      <!-- світло-зелений -->
        <Setter Property="Foreground" Value="#2f4f2f"/>      <!-- темно-зелений текст -->
        <Setter Property="FontWeight" Value="Bold"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="Padding" Value="14,6"/>
        <Setter Property="BorderBrush" Value="#8BCF90"/>
        <Setter Property="BorderThickness" Value="2"/>
        <Setter Property="CornerRadius" Value="6"/>
        <Setter Property="HorizontalAlignment" Value="Right"/>
        <Setter Property="VerticalAlignment" Value="Center"/>

        <!-- Анімація при наведенні -->
        <Style.Animations>
            <Animation Duration="0.12">
                <KeyFrame Cue="0%">
                    <Setter Property="Background" Value="#C5F5C7"/>
                </KeyFrame>
                <KeyFrame Cue="100%">
                    <Setter Property="Background" Value="#A8E3AB"/>
                </KeyFrame>
            </Animation>
        </Style.Animations>

        <Style.Triggers>
            <!-- Hover -->
            <SelectorTrigger Selector="Button.new-game-button:pointerover">
                <Setter Property="Background" Value="#A8E3AB"/>   <!-- темніший зелений -->
                <Setter Property="BorderBrush" Value="#7FBF85"/>
            </SelectorTrigger>

            <!-- Disabled -->
            <SelectorTrigger Selector="Button.new-game-button:disabled">
                <Setter Property="Background" Value="#D8E8D8"/>
                <Setter Property="Foreground" Value="#8FA48F"/>
                <Setter Property="BorderBrush" Value="#C4D5C4"/>
            </SelectorTrigger>
        </Style.Triggers>
    </Style>

</Window>